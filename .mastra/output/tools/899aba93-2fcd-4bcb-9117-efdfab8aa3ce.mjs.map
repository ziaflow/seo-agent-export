{"version":3,"file":"899aba93-2fcd-4bcb-9117-efdfab8aa3ce.mjs","sources":["../../../src/mastra/tools/monitoringPulseTool.ts"],"sourcesContent":["import { createTool } from \"@mastra/core/tools\";\r\nimport { z } from \"zod\";\r\nimport { storeMonitoringPulse } from \"../storage/analyticsDb\";\r\n\r\n/**\r\n * Monitoring Pulse Tool\r\n * Records near-real-time telemetry signals for later analysis.\r\n */\r\nexport const monitoringPulseTool = createTool({\r\n  id: \"monitoring-pulse\",\r\n  description:\r\n    \"Captures telemetry signals (traffic shifts, schema errors, UX anomalies) and stores them for monitoring workflows.\",\r\n  inputSchema: z.object({\r\n    websiteUrl: z.string().url(),\r\n    signal: z.string().describe(\"Name of the signal, e.g., traffic_drop, schema_error\"),\r\n    severity: z.enum([\"info\", \"warning\", \"critical\"]),\r\n    metrics: z.record(z.any()).default({}),\r\n  }),\r\n  outputSchema: z.object({\r\n    websiteUrl: z.string(),\r\n    signal: z.string(),\r\n    severity: z.enum([\"info\", \"warning\", \"critical\"]),\r\n    metrics: z.record(z.any()),\r\n    observedAt: z.string(),\r\n  }),\r\n  execute: async ({ context, mastra }) => {\r\n    const logger = mastra?.getLogger();\r\n    const pulse = {\r\n      websiteUrl: context.websiteUrl,\r\n      signal: context.signal,\r\n      severity: context.severity,\r\n      metrics: context.metrics,\r\n      observedAt: new Date().toISOString(),\r\n    };\r\n\r\n    await storeMonitoringPulse(pulse);\r\n    logger?.info(\"ðŸ“¡ [Monitoring Pulse] Signal recorded\", {\r\n      signal: context.signal,\r\n      severity: context.severity,\r\n    });\r\n\r\n    return pulse;\r\n  },\r\n});\r\n"],"names":[],"mappings":";;;;;AAQO,MAAM,sBAAsB,UAAA,CAAW;AAAA,EAC5C,EAAA,EAAI,kBAAA;AAAA,EACJ,WAAA,EACE,oHAAA;AAAA,EACF,WAAA,EAAa,EAAE,MAAA,CAAO;AAAA,IACpB,UAAA,EAAY,CAAA,CAAE,MAAA,EAAO,CAAE,GAAA,EAAI;AAAA,IAC3B,MAAA,EAAQ,CAAA,CAAE,MAAA,EAAO,CAAE,SAAS,sDAAsD,CAAA;AAAA,IAClF,UAAU,CAAA,CAAE,IAAA,CAAK,CAAC,MAAA,EAAQ,SAAA,EAAW,UAAU,CAAC,CAAA;AAAA,IAChD,OAAA,EAAS,EAAE,MAAA,CAAO,CAAA,CAAE,KAAK,CAAA,CAAE,OAAA,CAAQ,EAAE;AAAA,GACtC,CAAA;AAAA,EACD,YAAA,EAAc,EAAE,MAAA,CAAO;AAAA,IACrB,UAAA,EAAY,EAAE,MAAA,EAAO;AAAA,IACrB,MAAA,EAAQ,EAAE,MAAA,EAAO;AAAA,IACjB,UAAU,CAAA,CAAE,IAAA,CAAK,CAAC,MAAA,EAAQ,SAAA,EAAW,UAAU,CAAC,CAAA;AAAA,IAChD,OAAA,EAAS,CAAA,CAAE,MAAA,CAAO,CAAA,CAAE,KAAK,CAAA;AAAA,IACzB,UAAA,EAAY,EAAE,MAAA;AAAO,GACtB,CAAA;AAAA,EACD,OAAA,EAAS,OAAO,EAAE,OAAA,EAAS,QAAO,KAAM;AACtC,IAAA,MAAM,MAAA,GAAS,QAAQ,SAAA,EAAU;AACjC,IAAA,MAAM,KAAA,GAAQ;AAAA,MACZ,YAAY,OAAA,CAAQ,UAAA;AAAA,MACpB,QAAQ,OAAA,CAAQ,MAAA;AAAA,MAChB,UAAU,OAAA,CAAQ,QAAA;AAAA,MAClB,SAAS,OAAA,CAAQ,OAAA;AAAA,MACjB,UAAA,EAAA,iBAAY,IAAI,IAAA,EAAK,EAAE,WAAA;AAAY,KACrC;AAEA,IAAA,MAAM,qBAAqB,KAAK,CAAA;AAChC,IAAA,MAAA,EAAQ,KAAK,8CAAA,EAAyC;AAAA,MACpD,QAAQ,OAAA,CAAQ,MAAA;AAAA,MAChB,UAAU,OAAA,CAAQ;AAAA,KACnB,CAAA;AAED,IAAA,OAAO,KAAA;AAAA,EACT;AACF,CAAC;;;;"}